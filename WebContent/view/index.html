<!DOCTYPE html>
<html>
	<head>
		<meta charset="ISO-8859-1">
		<title>INDEX</title>
		<!--Import materialize.css-->
		<link type="text/css" rel="stylesheet" href="lib/materialize/v0.97.0/css/materialize.min.css"  media="screen,projection"/>
		<link type="text/css" rel="stylesheet" href="lib/jstree/dist/themes/default/style.min.css" />
		<link rel="stylesheet" type="text/css" href="css/elements.css" />
		<!--Let browser know website is optimized for mobile-->
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
	</head>

	<body>
		<div id="view" style="height: 500px;"></div>
	</body>

	<script src="lib/jquery-1.11.2/jquery.min.js"></script>
	<script type="text/javascript" src="lib/materialize/v0.97.0/js/materialize.min.js"></script>
	<script src="lib/jstree/dist/jstree.min.js"></script>
	
	<script src="js/elements.js"></script>
	<script src="js/mapper.js"></script>
	<script src="js/servicos.js"></script>
	
	
	<script type="text/javascript">
	 var contexto = {
		    	home: undefined
		    	,
				pastaAtual: undefined
				,
				pastaRightClick: {
					dados: undefined
					,
					bloco: undefined
				},
				favoritoRightClick: {
					dados: undefined
					,
					bloco: undefined
				},
				acessoRapidoRightClick: {
					dados: undefined
				},
				favAcessoRapidoSelecionado: {
					dados: undefined	
				}
		    }
	
	 
	 var atualizarAcessoRapido = function(){
	    	var criarMensagemDeAjuda = function(){
	    		var container = $('<div align="center" class="arrastar-favorito-msg">');
	    		container.append("Arraste um favorito aqui adicioná-lo em seu acesso rápido")
	    		return container;
	    	}
	    	servicos.buscarAcessoRapido(
				function(data){
					var container = $('#acessoRapido');
					container.empty();
					if (data.content.length == 0){
						container.append(criarMensagemDeAjuda());
						container.addClass("border-dashed");
					}
					else{
						container.removeClass("border-dashed");
						insereIcons(data.content, container);
					}
				}
			)
	    }
	 
		var btnModal = undefined;
		servicos.buscarHierarquiaDePastas(
	   		function(data){
	   			var listaRapida = Element.ListaDeFavoritosRapida(
					data.content
					,
					servicos.buscarArquivos
					,
					function(favorito){
						alert('inserir no acesso rápido o favorito ' + favorito.titulo);
						contexto.favAcessoRapidoSelecionado.dados = favorito;
						btnModal.removeClass('disabled');
					}
				);

	   			
	   			var modal = Element.ModalConfirm(
   					"Selecionar favorito"
   					, 
   					function(){
   						servicos.adicionarAcessoRapido(
   								contexto.favAcessoRapidoSelecionado.id
   								,
   								function(){
   									atualizarAcessoRapido();
   								}
   							)
   						modal.close();
   						alert("adicionar na lista");
   					}
   				);
	   				
   				modal.addConteudo(listaRapida.getElement());
   				modal.show();	
   				btnModal = $('.btn-confirmar', modal.getElement());
   				btnModal.addClass('disabled');
	   		}
	    )
	</script>
</html>